/*!
 * jquery-image-changer
 * author: tsuyoshiwada
 * version: 2.0.7
 * license: MIT
 * copyright: tsuyoshiwada
 */
!function(t,i){"use strict";"object"==typeof module&&"object"==typeof module.exports?i(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],i):i(t.jQuery)}(this,function(t){"use strict";function i(t,i,e){return Array.prototype.slice.call(t,i,void 0!==e?e:t.length)}function e(t){return!t||""===t||0===t}function s(t,i){return null!=t&&Object.prototype.hasOwnProperty.call(t,i)}function n(i){var e="string"===t.type(i)?i.split("|"):i.concat();return"\\."+e.join("|\\.")}function o(){return"string"===t.type(arguments[0])?o.callAPI.apply(this,arguments):void this._initialize.apply(this,arguments)}function a(i,e){v.builtin[i]=t.extend({},v.base,e)}function r(t){delete v.builtin[t]}function h(i,e,s){return e=e||u.suffix,s=s||_,"string"===t.type(i)&&i.match(new RegExp("^(.+)"+e+"("+s+")$","gi"))?!0:!1}function f(i,e,s){if(e=e||u.suffix,s=s||_,"string"===t.type(i))return h.apply(this,arguments)?i:i.replace(new RegExp("^(.+)("+s+")$","gi"),"$1"+e+"$2");if(i&&i.jquery){var n,o,a=[];return i.each(function(){n=t(this),n.is("img")?(o=f(n.attr("src"),e,s),n.attr("src",o),a.push(o)):a=a.concat(f(n.find("img"),e,s))}),a}return!1}function c(i,e,s){if(e=e||u.suffix,s=s||_,"string"===t.type(i))return h.apply(this,arguments)?i.replace(new RegExp("^(.+)("+e+")("+s+")$","gi"),"$1$3"):i;if(i&&i.jquery){var n,o,a=[];return i.each(function(){n=t(this),n.is("img")?(o=c(n.attr("src"),e,s),n.attr("src",o),a.push(o)):a=a.concat(c(n.find("img"),e,s))}),a}return!1}function p(i,e,s){if(e=e||u.suffix,s=s||_,"string"===t.type(i))return h.apply(this,arguments)?c.apply(this,arguments):f.apply(this,arguments);if(i&&i.jquery){var n,o,a=[];return i.each(function(){n=t(this),n.is("img")?(o=p(n.attr("src"),e,s),n.attr("src",o),a.push(o)):a=a.concat(p(n.find("img"),e,s))}),a}return!1}var l="2.0.7",u={suffix:"_on",hover:!0,transition:{type:"fade"},backgroundImage:!1,imageTypes:"jpg|jpeg|gif|png",beforeInit:!1,afterInit:!1,beforeChange:!1,afterChange:!1,beforeOnImage:!1,afterOnImage:!1,beforeOffImage:!1,afterOffImage:!1},g=t.map(u,function(t,i){return i}),m="ic",d={ROLL_OVER:"mouseenter."+m,ROLL_OUT:"mouseleave."+m,CLICK:"click."+m},y={TOUCH_START:"touchstart."+m,TOUCH_END:"touchend."+m,TOUCH_MOVE:"touchmove."+m},$={image:m+"-image",inner:m+"-inner",on:m+"-on",off:m+"-off"},b="ontouchstart"in window,v={builtin:{},base:{defaults:{duration:150,easing:"linear",opacity:0},initialize:function(t){t=t,this.$on.css("opacity",0)},on:function(t,i){t=t,this.$on.css("opacity",1),this.$off.css("opacity",0),i()},off:function(t,i){t=t,this.$on.css("opacity",0),this.$off.css("opacity",1),i()},destroy:function(){}}};o.prototype._initialize=function(i,s){if(this.version=l,this.options=null,this.transition=null,this.imageTypes="",this.$elem=null,this.$img=null,this.$parant=null,this.$on=null,this.$off=null,this.status={active:!1,animate:!1,enable:!1,loaded:!1,error:!1},this.touchTimer=!1,this.on="",this.off="",this.$elem=i,this.options=s,this._callbackApply("beforeInit",s.beforeInit)===!1)return!1;this.$img=i.find("img"),this.$parent=this.$img.parent(),this.transition=this._getTransition(),this.imageTypes=n(s.imageTypes);var o="";if(s.backgroundImage?(o=this.$elem.css("background-image")||"",o=o.match(/url\((\S+)\)/)?RegExp.$1:"",o=o.replace(/"/g,"")):o=this.$img.attr("src"),e(o))return!1;var a=this._hasSuffix(o);a?(this.on=o,this.off=this._removeSuffix(o),this.status.active=!0):(this.on=this._addSuffix(o),this.off=o),this._buildHtml(),t("<img>").on("load",t.proxy(this._loadSuccess,this)).on("error",t.proxy(this._loadError,this)).attr("src",a?this.off:this.on)},o.prototype._buildHtml=function(){var i,e,s,n,o,a=this.$elem,r=a.html(),h={width:a.width(),height:a.height()};if(this.options.backgroundImage===!0){var f={position:"absolute",zIndex:1,top:0,left:0,display:"inline-block",width:h.width,height:h.height};o=a.css("position"),o="static"!=o?o:"relative",f.zIndex=3,i=t("<span>").addClass($.inner).css(f).html(r),f.zIndex=2,f.backgroundImage="url("+this.off+")",s=t("<span>").addClass($.off).css(f),f.zIndex=1,f.backgroundImage="url("+this.on+")",n=t("<span>").addClass($.on).css(f),a.css({"background-image":"transparent",position:o}).append(i).append(s).append(n)}else{var c={position:"absolute",zIndex:1},p={};s=this.$img,o=s.css("position"),n=t(t("<div>").append(s.clone()).html()).addClass($.on).attr("src",this.on),s.wrap('<span class="'+$.image+'" style="position:relative; display:inline-block; /display:inline;"></span>'),e=this.$elem.find($.image),"static"===o?(p.position="relative",c.top=0,c.left=0):(c.top=s.css("top"),c.right=s.css("right"),c.bottom=s.css("bottom"),c.left=s.css("left")),n.css(c),s.css(p),s.css("z-index",2).addClass($.off),this.$elem.find("."+$.image).append(n)}this.$on=n,this.$off=s,this.$inner=i,this.$image=e,this.status.active&&this.$off.attr("src",this.off).css("opacity",0)},o.prototype._unbuildHtml=function(){this.options.backgroundImage===!0?(this.$elem.css({"background-image":"",position:""}),this.$inner.remove(),this.$on.remove(),this.$off.remove()):(this.$img.unwrap(),this.$on.remove(),this.$off.css({position:"","z-index":""}).removeClass($.off))},o.prototype._loadSuccess=function(){this.status.enable=this.status.loaded=!0,this._bindEvents(),this.transition.initialize.call(this,t.extend(!0,{},this.transition.defaults,this.options.transition)),this._callbackApply("afterInit",this.options.afterInit,"success")},o.prototype._loadError=function(){this.status.error=!0,this._callbackApply("afterInit",this.options.afterInit,"error")},o.prototype._bindEvents=function(){this.options.hover===!0&&(b?this.$elem.on(y.TOUCH_START,t.proxy(this._onTouchStartHandler,this)).on(y.TOUCH_END,t.proxy(this._onTouchEndHandler,this)).on(y.TOUCH_MOVE,t.proxy(this._onTouchMoveHandler,this)):this.$elem.on(d.ROLL_OVER,t.proxy(this._onRollOverHandler,this)).on(d.ROLL_OUT,t.proxy(this._onRollOutHandler,this)))},o.prototype._unbindEvents=function(){this.options.hover===!0&&(b?this.$elem.off(y.TOUCH_START).off(y.TOUCH_END).off(y.TOUCH_MOVE):this.$elem.off(d.ROLL_OVER).off(d.ROLL_OUT))},o.prototype._onRollOverHandler=function(){this.onImage()},o.prototype._onRollOutHandler=function(){this.offImage()},o.prototype._onTouchStartHandler=function(){this.onImage()},o.prototype._onTouchEndHandler=function(){this.offImage()},o.prototype._onTouchMoveHandler=function(){this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(t.proxy(this.offImage,this),200)},o.prototype._callbackApply=function(){var e=arguments[0],s=arguments[1],n=i(arguments,2),o=t.isFunction(s)?s:function(){},a=o.apply(this,n),r=new t.Event(m+"."+e);return r.target=this.$elem,this.$elem.trigger(r,this),a},o.prototype._hasSuffix=function(t){return h(t,this.options.suffix,this.imageTypes)},o.prototype._addSuffix=function(t){return f(t,this.options.suffix,this.imageTypes)},o.prototype._removeSuffix=function(t){return c(t,this.options.suffix,this.imageTypes)},o.prototype._transition=function(i,e){var s=this,n=t.extend({},s.transition.defaults,s.options.transition||{});s.transition[i].call(s,n,function(){e.call(s)})},o.prototype._getTransition=function(){var i=this.options.transition,e=i?i.type:"";if(i===!1||"none"===i||"default"===i)return t.extend({},v.base);if(s(v.builtin,i))return v.builtin[i];if(s(v.builtin,e))return v.builtin[e];if("custom"===e)return t.extend({},v.base,i);throw new Error("[ImageChanger] :: Is invalid specification of transition.")},o.prototype.isChangeEnable=function(){return!this.status.error&&this.status.enable},o.prototype.toggle=function(t){this.status.active?this.offImage(t):this.onImage(t)},o.prototype.onImage=function(i){return!this.isChangeEnable()||this.status.active?!1:this._callbackApply("beforeChange",this.options.beforeChange,"on")===!1?!1:this._callbackApply("beforeOnImage",this.options.beforeOnImage)===!1?!1:(this.status.active=!0,this.status.animate=!0,void this._transition("on",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"on"),this._callbackApply("afterOnImage",this.options.afterOnImage),t.isFunction(i)&&i.call(this)}))},o.prototype.offImage=function(i){return this.isChangeEnable()&&this.status.active?this._callbackApply("beforeChange",this.options.beforeChange,"off")===!1?!1:this._callbackApply("beforeOffImage",this.options.beforeOffImage)===!1?!1:(this.status.active=!1,this.status.animate=!0,void this._transition("off",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"off"),this._callbackApply("afterOffImage",this.options.afterOffImage),t.isFunction(i)&&i.call(this)})):!1},o.prototype.disable=function(){this.status.enable=!1},o.prototype.enable=function(){this.status.error||(this.status.enable=!0)},o.prototype.destroy=function(){return this.$elem.data("imageChanger")?(this.transition.destroy.call(this),this._unbindEvents(),this._unbuildHtml(),this.status.enable=!1,void this.$elem.removeData("imageChanger")):!1};var _=n(u.imageTypes);o.callAPI=function(){var t=arguments[0],e=i(arguments,1);switch(t){case"addSuffix":return f.apply(this,e);case"removeSuffix":return c.apply(this,e);case"toggleSuffix":return p.apply(this,e);case"registerTransition":return a.apply(this,e);case"unregisterTransition":return r.apply(this,e);default:throw new Error("[ImageChanger] :: Is invalid specification of Global API.")}},o.registerTransition=function(){a.apply(this,arguments)},o.unregisterTransition=function(){r.apply(this,arguments)},a("fade",{initialize:function(t){this.$on.css("opacity",0)},on:function(t,i){var e=t.duration,s=t.easing;this.$on.css("opacity",1),this.$off.stop().animate({opacity:t.opacity},e,s,i)},off:function(t,i){var e=t.duration,s=t.easing;this.$on.stop().animate({opacity:1},e/2,s),this.$off.stop().animate({opacity:1},e,s,i)},destroy:function(){this.$off.stop(!0,!0).css("opacity",""),this.$on.stop(!0,!0).css("opacity","")}}),a("wink",{defaults:{duration:150,easing:"swing",opacity:.4},initialize:function(t){this.$on.css("opacity",0)},on:function(t,i){if(this.$off.is(":animated"))return i();var e=t.duration,s=t.easing;this.$on.stop().animate({opacity:1},e,s).animate({opacity:0},e,s),this.$off.stop().animate({opacity:t.opacity},e,s).animate({opacity:1},e,s,i)},off:function(t,i){t=t,i()},destroy:function(){this.$on.stop(!0,!0).css("opacity",""),this.$off.stop(!0,!0).css("opacity","")}}),a("slide",{defaults:{duration:150,easing:"swing",direction:"top",display:"inline-block"},initialize:function(t){var i="static"===this.$elem.css("position")?"relative":this.$elem.css("position"),e="inline"===this.$elem.css("display")?t.display:this.$elem.css("display");this.$elem.css({position:i,overflow:"hidden",display:e});var s={width:this.$elem.width(),height:this.$elem.height()};switch(t.direction){case"top":this.$off.css({top:0}),this.$on.css({top:s.height});break;case"right":this.$off.css({left:0}),this.$on.css({left:-s.width});break;case"bottom":this.$off.css({top:0}),this.$on.css({top:-s.height});break;case"left":this.$off.css({left:0}),this.$on.css({left:s.width})}},on:function(t,i){var e={width:this.$elem.width(),height:this.$elem.height()},s=t.duration,n=t.easing;switch(this.$off.stop(),this.$on.stop(),t.direction){case"top":this.$off.animate({top:-e.height},s,n),this.$on.animate({top:0},s,n,i);break;case"right":this.$off.animate({left:e.width},s,n),this.$on.animate({left:0},s,n,i);break;case"bottom":this.$off.animate({top:e.height},s,n),this.$on.animate({top:0},s,n,i);break;case"left":this.$off.animate({left:-e.width},s,n),this.$on.animate({left:0},s,n,i)}},off:function(t,i){var e={width:this.$elem.width(),height:this.$elem.height()},s=t.duration,n=t.easing;switch(this.$off.stop(),this.$on.stop(),t.direction){case"top":this.$off.animate({top:0},s,n),this.$on.animate({top:e.height},s,n,i);break;case"right":this.$off.animate({left:0},s,n),this.$on.animate({left:-e.width},s,n,i);break;case"bottom":this.$off.animate({top:0},s,n),this.$on.animate({top:-e.height},s,n,i);break;case"left":this.$off.animate({left:0},s,n),this.$on.animate({left:e.width},s,n,i)}},destroy:function(){var t={top:"",right:"",bottom:"",left:""};this.$off.stop(!0,!0).css(t),this.$on.stop(!0,!0).css(t),this.$elem.css({position:"",overflow:"",display:""})}}),t.imageChanger=t.imageChanger||o,t.fn.imageChanger=function(i){return this.each(function(){var e,s=t(this),n={};s.data("imageChanger")||(t.each(g,function(i,o){e=s.data(t.camelCase(m+"-"+o.toLowerCase())),void 0!==e&&(n[o]=e)}),s.data("imageChanger",new o(s,t.extend(!0,{},u,i,n))))})}});