/*!
 * jquery-image-changer
 * author: tsuyoshiwada
 * version: 2.0.3
 * license: MIT
 * copyright: tsuyoshiwada
 */
!function(t,i){"use strict";"object"==typeof module&&"object"==typeof module.exports?i(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],i):i(t.jQuery)}(this,function(t){"use strict";function i(){this.version=o,this.options=null,this.transition=null,this.imageTypes="",this.$elem=null,this.$img=null,this.$parant=null,this.$on=null,this.$off=null,this.status={active:!1,animate:!1,enable:!1,loaded:!1,error:!1},this.touchTimer=!1,this.on="",this.off="",this._initialize.apply(this,arguments)}function e(t,i,e){return Array.prototype.slice.call(t,i,void 0!==e?e:t.length)}function s(t){return!t||""===t||0===t}var o="2.0.3",n={suffix:"_on",hover:!0,transition:{type:"fade"},backgroundImage:!1,imageTypes:"jpg|jpeg|gif|png",beforeInit:!1,afterInit:!1,beforeChange:!1,afterChange:!1,beforeOnImage:!1,afterOnImage:!1,beforeOffImage:!1,afterOffImage:!1},a=t.map(n,function(t,i){return i}),r="ic",h={ROLL_OVER:"mouseenter."+r,ROLL_OUT:"mouseleave."+r,CLICK:"click."+r},f={TOUCH_START:"touchstart."+r,TOUCH_END:"touchend."+r,TOUCH_MOVE:"touchmove."+r},p={image:r+"-image",inner:r+"-inner",on:r+"-on",off:r+"-off"},l="ontouchstart"in window,c=void 0===window.addEventListener&&void 0===document.querySelectorAll;t.imageChanger=t.imageChanger||{};var u=t.imageChanger.transition={builtin:{}};u.base={defaults:{duration:150,easing:"linear",opacity:0},initialize:function(t){t=t},on:function(t,i){t=t,this.$off.css("opacity",0),i.call()},off:function(t,i){t=t,this.$off.css("opacity",1),i.call()},destroy:function(){}},t.imageChanger.registerTransition=function(i,e){u.builtin[i]=t.extend({},u.base,e)},t.imageChanger.unregisterTransition=function(t){delete u.builtin[t]},i.prototype._initialize=function(i,e){if(this.$elem=i,this.options=e,this._callbackApply("beforeInit",e.beforeInit)===!1)return!1;this.$img=i.find("img"),this.$parent=this.$img.parent(),this.transition=this._getTransition(),this.imageTypes="string"===t.type(e.imageTypes)?e.imageTypes.split("|"):e.imageTypes,this.imageTypes="\\."+this.imageTypes.join("|\\.");var o="";if(e.backgroundImage?(o=this.$elem.css("background-image")||"",o=o.match(/url\((\S+)\)/)?RegExp.$1:"",o=o.replace(/"/g,"")):o=this.$img.attr("src"),s(o))return!1;var n=this._hasSuffix(o);n?(this.on=o,this.off=this._removeSuffix(o),this.status.active=!0):(this.on=this._addSuffix(o),this.off=o),this._buildHtml(),t("<img>").on("load",t.proxy(this._loadSuccess,this)).on("error",t.proxy(this._loadError,this)).attr("src",n?this.off:this.on)},i.prototype._buildHtml=function(){var i,e,s,o,n,a=this.$elem,r=a.html(),h={width:a.width(),height:a.height()};if(this.options.backgroundImage===!0){var f={position:"absolute",zIndex:1,top:0,left:0,display:"inline-block",width:h.width,height:h.height};n=a.css("position"),n="static"!=n?n:"relative",f.zIndex=3,i=t("<span>").addClass(p.inner).css(f).html(r),f.boxShadow="0 0 1px rgba(0,0,0,.01)",f.zIndex=2,f.backgroundImage="url("+this.off+")",s=t("<span>").addClass(p.off).css(f),f.zIndex=1,f.backgroundImage="url("+this.on+")",o=t("<span>").addClass(p.on).css(f),a.css({"background-image":"transparent",position:n}).append(i).append(s).append(o)}else{var l={position:"absolute",zIndex:1,boxShadow:"0 0 1px rgba(0,0,0,.01)"},c={boxShadow:"0 0 1px rgba(0,0,0,.01)"};s=this.$img,n=s.css("position"),o=t(t("<div>").append(s.clone()).html()).addClass(p.on).attr("src",this.on),s.wrap('<span class="'+p.image+'" style="position:relative; display:inline-block; /display:inline; /zoom:1;"></span>'),e=this.$elem.find(p.image),"static"===n?(c.position="relative",l.top=0,l.left=0):(l.top=s.css("top"),l.right=s.css("right"),l.bottom=s.css("bottom"),l.left=s.css("left")),o.css(l),s.css(c),s.css("z-index",2).addClass(p.off),this.$elem.find("."+p.image).append(o)}this.$on=o,this.$off=s,this.$inner=i,this.$image=e,this.status.active&&this.$off.attr("src",this.off).css("opacity",0)},i.prototype._unbuildHtml=function(){this.options.backgroundImage===!0?(this.$elem.css({"background-image":"",position:""}),this.$inner.remove(),this.$on.remove(),this.$off.remove()):(this.$img.unwrap(),this.$on.remove(),this.$off.css({position:"","z-index":""}).removeClass(p.off))},i.prototype._loadSuccess=function(){this.status.enable=this.status.loaded=!0,this._bindEvents(),this.transition.initialize.call(this,t.extend({},this.transition.defaults,this.options.transition)),this._callbackApply("afterInit",this.options.afterInit,"success")},i.prototype._loadError=function(){this.status.error=!0,this._callbackApply("afterInit",this.options.afterInit,"error")},i.prototype._bindEvents=function(){var i=this;i.options.hover===!0&&(l?i.$elem.on(f.TOUCH_START,t.proxy(i._onTouchStartHandler,i)).on(f.TOUCH_END,t.proxy(i._onTouchEndHandler,i)).on(f.TOUCH_MOVE,t.proxy(i._onTouchMoveHandler,i)):i.$elem.on(h.ROLL_OVER,t.proxy(i._onRollOverHandler,i)).on(h.ROLL_OUT,t.proxy(i._onRollOutHandler,i))),c&&i.$parent.is("a")&&i.$parent.css("cursor","pointer").on(h.CLICK,function(i){i.preventDefault();var e=t(this).attr("href"),s=t(this).attr("target");"_blank"===s?window.open(e,s):location.href=e})},i.prototype._unbindEvents=function(){this.options.hover===!0&&(l?this.$elem.off(f.TOUCH_START).off(f.TOUCH_END).off(f.TOUCH_MOVE):this.$elem.off(h.ROLL_OVER).off(h.ROLL_OUT)),c&&this.$parent.is("a")&&this.$parent.css("cursor","").off(h.CLICK)},i.prototype._onRollOverHandler=function(){this.onImage()},i.prototype._onRollOutHandler=function(){this.offImage()},i.prototype._onTouchStartHandler=function(){this.onImage()},i.prototype._onTouchEndHandler=function(){this.offImage()},i.prototype._onTouchMoveHandler=function(){this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(t.proxy(this.offImage,this),200)},i.prototype._callbackApply=function(){var i=arguments[0],s=arguments[1],o=e(arguments,2),n=t.isFunction(s)?s:function(){},a=n.apply(this,o),h=new t.Event(r+"."+i);return h.target=this.$elem,this.$elem.trigger(h,this),a},i.prototype._hasSuffix=function(t){return t.match(new RegExp("^(.+)"+this.options.suffix+"("+this.imageTypes+")$","gi"))?!0:!1},i.prototype._addSuffix=function(t){return t.replace(new RegExp("^(.+)("+this.imageTypes+")$","gi"),"$1"+this.options.suffix+"$2")},i.prototype._removeSuffix=function(t){return t.replace(new RegExp("^(.+)("+this.options.suffix+")("+this.imageTypes+")$","gi"),"$1$3")},i.prototype._transition=function(i,e){var s=this,o=t.extend({},s.transition.defaults,s.options.transition||{});s.transition[i].call(s,o,function(){e.call(s)})},i.prototype._getTransition=function(){if(this.options.transition===!1||"none"===this.options.transition)return t.extend({},u.base);if(u.builtin.hasOwnProperty(this.options.transition.type))return u.builtin[this.options.transition.type];if("custom"===this.options.transition.type)return t.extend({},u.base,this.options.transition);throw new Error("[ImageChanger] :: Is invalid specification of transition.")},i.prototype.isChangeEnable=function(){return!this.status.error&&this.status.enable},i.prototype.toggle=function(t){this.status.active?this.offImage(t):this.onImage(t)},i.prototype.onImage=function(i){return!this.isChangeEnable()||this.status.active?!1:this._callbackApply("beforeChange",this.options.beforeChange,"on")===!1?!1:this._callbackApply("beforeOnImage",this.options.beforeOnImage)===!1?!1:(this.status.active=!0,this.status.animate=!0,void this._transition("on",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"on"),this._callbackApply("afterOnImage",this.options.afterOnImage),t.isFunction(i)&&i.call(this)}))},i.prototype.offImage=function(i){return this.isChangeEnable()&&this.status.active?this._callbackApply("beforeChange",this.options.beforeChange,"off")===!1?!1:this._callbackApply("beforeOffImage",this.options.beforeOffImage)===!1?!1:(this.status.active=!1,this.status.animate=!0,void this._transition("off",function(){this.status.animate=!1,this._callbackApply("afterChange",this.options.afterChange,"off"),this._callbackApply("afterOffImage",this.options.afterOffImage),t.isFunction(i)&&i.call(this)})):!1},i.prototype.disable=function(){this.status.enable=!1},i.prototype.enable=function(){this.status.error||(this.status.enable=!0)},i.prototype.destroy=function(){return this.$elem.data("imageChanger")?(this.transition.destroy.call(this),this._unbindEvents(),this._unbuildHtml(),this.status.enable=!1,void this.$elem.removeData("imageChanger")):!1},t.imageChanger.registerTransition("fade",{on:function(t,i){this.$off.stop().animate({opacity:t.opacity},t.duration,t.easing,i)},off:function(t,i){this.$off.stop().animate({opacity:1},t.duration,t.easing,i)},destroy:function(){this.$off.stop(!0,!0).css("opacity","")}}),t.imageChanger.registerTransition("wink",{defaults:{duration:150,easing:"swing",opacity:.4},on:function(t,i){this.$off.is(":animated")?i.call():this.$off.stop().animate({opacity:t.opacity},t.duration,t.easing).animate({opacity:1},t.duration,t.easing,i)},off:function(t,i){t=t,i.call()},destroy:function(){this.$off.stop(!0,!0).css("opacity","")}}),t.imageChanger.registerTransition("slide",{defaults:{duration:150,easing:"swing",direction:"top",display:"inline-block"},initialize:function(t){var i="static"===this.$elem.css("position")?"relative":this.$elem.css("position"),e="inline"===this.$elem.css("display")?t.display:this.$elem.css("display");this.$elem.css({position:i,overflow:"hidden",display:e});var s={width:this.$elem.width(),height:this.$elem.height()};switch(t.direction){case"top":this.$off.css({top:0}),this.$on.css({top:s.height});break;case"right":this.$off.css({left:0}),this.$on.css({left:-s.width});break;case"bottom":this.$off.css({top:0}),this.$on.css({top:-s.height});break;case"left":this.$off.css({left:0}),this.$on.css({left:s.width})}},on:function(t,i){var e={width:this.$elem.width(),height:this.$elem.height()};switch(t.direction){case"top":this.$off.stop().animate({top:-e.height},t.duration,t.easing),this.$on.stop().animate({top:0},t.duration,t.easing,i);break;case"right":this.$off.stop().animate({left:e.width},t.duration,t.easing),this.$on.stop().animate({left:0},t.duration,t.easing,i);break;case"bottom":this.$off.stop().animate({top:e.height},t.duration,t.easing),this.$on.stop().animate({top:0},t.duration,t.easing,i);break;case"left":this.$off.stop().animate({left:-e.width},t.duration,t.easing),this.$on.stop().animate({left:0},t.duration,t.easing,i)}},off:function(t,i){var e={width:this.$elem.width(),height:this.$elem.height()};switch(t.direction){case"top":this.$off.stop().animate({top:0},t.duration,t.easing),this.$on.stop().animate({top:e.height},t.duration,t.easing,i);break;case"right":this.$off.stop().animate({left:0},t.duration,t.easing),this.$on.stop().animate({left:-e.width},t.duration,t.easing,i);break;case"bottom":this.$off.stop().animate({top:0},t.duration,t.easing),this.$on.stop().animate({top:-e.height},t.duration,t.easing,i);break;case"left":this.$off.stop().animate({left:0},t.duration,t.easing),this.$on.stop().animate({left:e.width},t.duration,t.easing,i)}},destroy:function(){var t={top:"",right:"",bottom:"",left:""};this.$off.stop(!0,!0).css(t),this.$on.stop(!0,!0).css(t),this.$elem.css({position:"",overflow:"",display:""})}}),t.fn.imageChanger=function(e){return this.each(function(){var s,o=t(this),h={};o.data("imageChanger")||(t.each(a,function(i,e){s=o.data(t.camelCase(r+"-"+e.toLowerCase())),void 0!==s&&(h[e]=s)}),o.data("imageChanger",new i(o,t.extend({},n,e,h))))})}});